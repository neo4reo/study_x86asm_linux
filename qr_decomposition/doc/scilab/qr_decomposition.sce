//       1         2         3         4         5         6         7
//34567890123456789012345678901234567890123456789012345678901234567890
//////////////////////////////////////////////////////////////////////
//
// Title: Calculate QR Decomposition using Gram-Schmidt Method
//
//--------------------------------------------------------------------
//       Author: Nik Mohamad Aizuddin bin Nik Azmi
// Date Created: 02-APR-2015
//--------------------------------------------------------------------
//
//                  MIT Licensed. See LICENSE file
//
//////////////////////////////////////////////////////////////////////

function[] = qr_decomposition()

    //////////////////////////////////////////////////////////////////
    // Let A = sample matrix
    //////////////////////////////////////////////////////////////////

    A = [4.000  0.021 -7.043 21.898
         0.000  3.000  0.873  3.202
         0.000  0.000  2.000 -3.642
         0.000  0.000  0.000  1.000];


    //////////////////////////////////////////////////////////////////
    // Find Q
    //////////////////////////////////////////////////////////////////

    j = 0;
    for i=1:1:size(A,'r')
        u(:,i) = A(:,i);
        if j == 0
            j = 1;
        else
            for k=1:1:j
                u(:,i) = u(:,i) - (A(:,i)'*e(:,k)).*e(:,k);
            end
            j = j + 1;
        end
        e(:,i) = u(:,i) / norm(u(:,i));
    end

    Q = e;


    //////////////////////////////////////////////////////////////////
    // Find R
    //////////////////////////////////////////////////////////////////

    R = zeros(size(A));
    k = 1;
    for i=k:1:size(A,'r')
        for j=k:1:size(A,'c')
            R(i, j) = A(:,j)' * e(:,i);
        end
        k = k + 1;
    end


    //////////////////////////////////////////////////////////////////
    // Show results
    //////////////////////////////////////////////////////////////////

    disp("Q = ");disp(Q);
    disp("R = ");disp(R);

endfunction